<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TzSafe User Manual</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="marigold-docs-theme/marigold.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guides/create-new-wallets.html"><strong aria-hidden="true">1.1.</strong> Create new wallets</a></li><li class="chapter-item expanded "><a href="guides/import-wallets.html"><strong aria-hidden="true">1.2.</strong> Import wallets</a></li><li class="chapter-item expanded "><a href="guides/fund-wallet.html"><strong aria-hidden="true">1.3.</strong> Fund wallet</a></li><li class="chapter-item expanded "><a href="guides/create-proposals.html"><strong aria-hidden="true">1.4.</strong> Create Proposals</a></li><li class="chapter-item expanded "><a href="guides/sign-reject-and-resolve-proposals.html"><strong aria-hidden="true">1.5.</strong> Sign, Reject and Resolve Proposals</a></li><li class="chapter-item expanded "><a href="guides/setting.html"><strong aria-hidden="true">1.6.</strong> Setting</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Developer DOC</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="guides/understand-entrypoint.html"><strong aria-hidden="true">2.1.</strong> Understand the Entrypoint</a></li><li class="chapter-item expanded "><a href="guides/login-using-tzsafe-app.html"><strong aria-hidden="true">2.2.</strong> Login using TzSafe app</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">TzSafe User Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/marigold-dev/tzsafe" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="welcome-to-tzsafe"><a class="header" href="#welcome-to-tzsafe">Welcome to TzSafe</a></h1>
<p>TzSafe offers a user-friendly platform for creating and managing multisig wallets. We prioritize the privacy of our users by not storing any of their private data. Information such as Tezos address aliases and regularly used wallets are exclusively stored locally in the user's browser.</p>
<p>Please note that the BETA version does not include the implementation of <a href="https://gitlab.com/tezos/tzip/-/merge_requests/202/diffs">TZIP-026</a>, which pertains to <em>Proof of Event: Message Signing as an alternative for Account Abstracted Wallets</em>. This TZIP is still on draft. Thus, it has not been integrated into the current version.</p>
<p>Before proceeding with any action, please ensure you use the correct URL: </p>
<ul>
<li>The Mainnet can be found at the URL: <a href="https://tzsafe.marigold.dev/">https://tzsafe.marigold.dev/</a>. We will provide biweekly updates on this platform regarding Marigold announcements.</li>
<li>The Ghostnet can be accessed at the URL: <a href="https://ghostnet.tzsafe.marigold.dev/">https://ghostnet.tzsafe.marigold.dev</a>. We will periodically update and release new changes on this platform without further announcement. </li>
</ul>
<p> Our platform currently supports both desktop and mobile devices for seamless accessibility.</p>
<figure><img src="assets/image (37).png" alt=""><figcaption><p>Access the Mainnet on a mobile device</p></figcaption></figure>
<div data-full-width="true">
<figure><img src="assets/image (22).png" alt=""><figcaption><p>Access the Mainnet on a desktop</p></figcaption></figure>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-new-wallets"><a class="header" href="#create-new-wallets">Create new wallets</a></h1>
<p>The first time we go to the website, we shall see two options in the center, <code>New Wallet</code> and <code>Import Wallet</code>, as the figure shows.</p>
<figure><img src="guides/../assets/image (7).png" alt=""><figcaption></figcaption></figure>
<p>Notice that upon logging into TzSafe on new devices, users will find that their TzSafe wallets do not automatically load. To access their wallets on the new device, users must load them manually through the import function. Please see <a href="guides/import-wallets.html">here</a> for importing our wallets.</p>
<p>Let’s click <code>New Wallet</code> to create our first blankly new multisig wallet! Before we start the creation process, it’s required to log in to our Tezos account. The purpose of login is to make Tezos operations, such as contract origination, transaction, etc. In this case, we arergoing to originate a TzSafe contract later.</p>
<figure><img src="guides/../assets/image (54).png" alt=""><figcaption></figcaption></figure>
<p>Now, we follow the step on UI to finish the remaining process of creation. First, name our wallet. The name is only stored in our browser locally. Therefore, no one will know what name we use for our wallet.</p>
<figure><img src="guides/../assets/image (4).png" alt=""><figcaption></figcaption></figure>
<p>Then, click <code>Continue</code> to proceed to the second step. The name can be changed on the <code>Address book</code> page later. Next, we will need to finish the setting as the figure shows.</p>
<figure><img src="guides/../assets/image (61).png" alt=""><figcaption></figcaption></figure>
<p>By default, TzSafe will put our Tezos account as an owner in <code>Owner Address</code><em>.</em> We can add more owners here.  It’s strongly recommended that add more owners. Please be extra careful here. If we aren’t one of the owners, we will lose control of the newly created wallet forever.</p>
<p>The <code>Owner Name</code> is optional. We may or may not fill it in but filling it is recommended that will help us easily identify Tezos account. If we don’t fill it, TzSafe will present in Tezos address.</p>
<p><code>Threshold</code> depends on the use case. In the above figure, the threshold is selected as <code>2/3</code>, indicating we are going to create a 2-of-3 TzSafe wallet. To be more specific, to successfully proceed any transaction on the wallet, we need at least two approvals from of its owners. </p>
<p><code>Proposal duration</code> is the lifetime of the proposal. A proposal can be approved by its owners only during its proposal duration. In the case of proposal exceeding its duration, any owner of the wallet can resolve it immediately but will not be executed. Then it will just be archived and put on the <code>history</code> page.</p>
<p>Notice that before we proceed the next step, please make sure that we are one of the owners. The rest of the settings could be adjusted later by issuing proposals on the <code>setting</code> page.</p>
<p>Finally, click <code>Continue</code> and wait for the wallet creation. It will need to a few minutes for confirmation.</p>
<figure><img src="guides/../assets/image (3).png" alt=""><figcaption></figcaption></figure>
<p>If a wallet has been created successfully, we will see as follow:</p>
<p>Currently, the creation fee, which is a one-time fee, is around 1.62 XTZ, depending on the number of owners.</p>
<figure><img src="guides/../assets/image (44).png" alt=""><figcaption></figcaption></figure>
<div style="break-before: page; page-break-before: always;"></div><h1 id="import-wallets"><a class="header" href="#import-wallets">Import wallets</a></h1>
<p>We can go to <code>Import wallet</code> to import any existing TzSafe wallet. TzSafe allows us to manage multiple wallets. The currently used wallets can be selected in the menu, as shown by the following figure.</p>
<figure><img src="guides/../assets/image (51).png" alt=""><figcaption></figcaption></figure>
<p>Notice that, even though we are not the owner of a wallet, we can still import it. Not being an owner just means we can’t make or sign proposals for the wallet. </p>
<p>The very first step of importing an existing wallet is to fill in its wallet address, and its alias if that's needed. The name can be modified in the <code>Address book</code> later.  </p>
<figure><img src="guides/../assets/image (57).png" alt=""><figcaption></figcaption></figure>
<p>Click <code>Continue</code> to go next, it’ll take a few seconds to load the setting of the wallet. Then, we can preview the settings. We can also give an alias to owner addresses in this step.</p>
<figure><img src="guides/../assets/image (14).png" alt=""><figcaption></figcaption></figure>
<p>Finally, save the wallet, and then it should be shown on the sidebar.</p>
<figure><img src="guides/../assets/image (9).png" alt=""><figcaption></figcaption></figure>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fund-wallet"><a class="header" href="#fund-wallet">Fund wallet</a></h1>
<p>After creating our TzSafe wallet, we may be eager to transfer our assets into it to bring it to life. The Fund wallet feature provides us with a simple and convenient way to use our logined Tezos account for funding the wallet.</p>
<p>To fund our TzSafe wallet, we can follow these steps:</p>
<ol>
<li>Click on <code>Fund Wallet</code> to access the funding page.</li>
<li>Enter the desired amount of XTZ or add FA1.2 and FA2 tokens by selecting <code>Add Token</code>.</li>
<li>Once the amount or tokens have been specified, click on <code>Fund</code> to initiate the transfer to our TzSafe wallet.</li>
</ol>
<figure><img src="guides/../assets/image (62).png" alt=""><figcaption></figcaption></figure>
<p>We should see the newly updated balance in XTZ of the wallet on the sidebar.</p>
<figure><img src="guides/../assets/image (29).png" alt=""><figcaption></figcaption></figure>
<p>For FA1.2 or FA2 tokens, when initiating new proposals, we will have visibility of them, giving us the ability to include them in the proposal.</p>
<figure><img src="guides/../assets/image (39).png" alt=""><figcaption></figcaption></figure>
<p>Notice that if there are multiple imported wallets, we will need to double-check which wallet we’re currently funding. Once we transfer out the XTZ, it will never come back.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-proposals"><a class="header" href="#create-proposals">Create Proposals</a></h1>
<p>The big difference from the Tezos account, or so-called single-signature account, is that</p>
<ul>
<li>The process of creating a proposal is mandatory for every transaction made from the TzSafe wallet.</li>
<li>batch transactions are allowed in TzSafe wallet.</li>
</ul>
<p>TzSafe supports the following types of transaction at the moment, with more to be added in the near future.</p>
<p>Notice that creating a proposal without any transaction is forbidden.</p>
<h2 id="supported-transaction"><a class="header" href="#supported-transaction">Supported Transaction <a href="guides/create-proposals.html#a5cb9fb8-9973-4df8-8989-a4ba408d59f3" id="a5cb9fb8-9973-4df8-8989-a4ba408d59f3"></a></a></h2>
<h3 id="xtz-transfer"><a class="header" href="#xtz-transfer">XTZ <strong>Transfer</strong> <a href="guides/create-proposals.html#1aa35605-14f1-4b72-99d8-f00991851324" id="1aa35605-14f1-4b72-99d8-f00991851324"></a></a></h3>
<p>This transaction allows us to transfer XTZ to the target account, including all <code>tz</code> accounts and <code>KT</code> accounts, which have a <code>%defaut</code> entrypoint with <code>unit</code> type.</p>
<p>First, click <code>New Proposal</code> on the sidebar. Then, click <code>Transfer</code>. Filling in the amount and the target address on UI. Before submitting, please double-check the address and transfer amount. Finally, click <code>Submit</code> to create our new proposal.</p>
<figure><img src="guides/../assets/image (42).png" alt=""><figcaption></figcaption></figure>
<p>Note that TzSafe doesn’t validate transferring amount is equal to or greater than the balance while the proposal is being created. The validation only happens when the proposal is executed. In other words, it's possible to fund an insufficient wallet before the proposal is executed.</p>
<h3 id="fa12-approve"><a class="header" href="#fa12-approve">FA1.2 Approve</a></h3>
<p>TzSafe provides support for approvals of FA1.2 tokens, allowing users to authorize the spending of tokens. </p>
<p>To create a new proposal, navigate to the sidebar and click on <code>New Proposal</code>. From there, select the option for <code>FA1.2 Approve</code>.  To grant approval, fill in the desired token and amount and the spender's address. Once the information is filled out, click the `Submit` button to complete the approval proposal.</p>
<figure><img src="guides/../assets/image (23).png" alt=""><figcaption></figcaption></figure>
<h3 id="fa12-transfer"><a class="header" href="#fa12-transfer">FA1.2 Transfer</a></h3>
<p>TzSafe also offers the capability to perform transfers for FA1.2 tokens. To create a new proposal, simply access the sidebar and click on <code>New Proposal</code>. Then, select the <code>FA1.2 Transfer</code> option from the available choices. Select the desired token, specify the amount, and provide the transfer-to address. Finally, click <code>Submit</code> to click a proposal.</p>
<figure><img src="guides/../assets/image (55).png" alt=""><figcaption></figcaption></figure>
<h3 id="fa2-transfer"><a class="header" href="#fa2-transfer"><strong>FA2 Transfer</strong></a></h3>
<p>TzSafe also provides support for transferring FA2 tokens. Currently, it allows for the transfer of multiple tokens within a single transaction, but with the restriction that all tokens must belong to the same FA2 contract. In cases where the FA2 tokens are spread across different contracts, it becomes necessary to create separate transactions for each contract involved.</p>
<p>To create a new proposal, navigate to the sidebar and click on <code>New Proposal</code>. From there, select the option for <code>FA2 Transfer</code>. Choose an FA2 token and specify the desired amount and the recipient's address. When adding a second token, please note that it must belong to the same FA2 contract as the first token. Finally, click the <code>Submit</code> button to create your new proposal.</p>
<figure><img src="guides/../assets/image (15).png" alt=""><figcaption></figcaption></figure>
<h3 id="contract-execution"><a class="header" href="#contract-execution"><strong>Contract Execution</strong></a></h3>
<p>Contract execution allows us to create a proposal to execute arbitrary Tezos contracts. Besides <code>FA2 Transfer</code>, we can also use <code>Contract Execution</code> to perform a transfer. </p>
<p>Taking an FA2 contract as an example, click <code>New Proposal</code> on the sidebar and select <code>Contract Execution</code>. Next, fill in a target address and the amount sent to the address. In this case, we fill FA2 address, <code>KT1Gh6T9CjpxEV6WxCzgExhrATEYtcLN5Fdp</code>, and amount 0.</p>
<figure><img src="guides/../assets/image (19).png" alt=""><figcaption></figcaption></figure>
<p>After click <code>Continue</code>, TzSafe will check if the contract of the given address exists. If so, we can see the contract parameters rendered on the page, as the following shows.</p>
<figure><img src="guides/../assets/image (25).png" alt=""><figcaption></figcaption></figure>
<p>To transfer FA2 tokens, we select the entrypoint <code>transfer</code> and click <code>Add item</code> to fill in the details. Finally, click the <code>Submit</code> button to create a new proposal. As the same as the transaction of transferring XTZ, an insufficient amount can be funded after proposal creation is done.</p>
<h3 id="batch"><a class="header" href="#batch"><strong>Batch</strong></a></h3>
<p>Sometimes we want to perform several transactions at the same time. In TzSafe, we can achieve it by using batch. A batch of transactions is <em>atomic</em>, which means any one of the transactions in one batch fails, all transactions fail.</p>
<p>This is useful when we want to <em>exchange</em> assets with others. For example, if we want to buy the NFT of Alice in 5XTZ, we will make two transactions as a batch. First, transfer 5XTZ to Alics. Second, call Alice’s contract to transfer NFT. We may want to have a third transaction to ensure NFT is in your name. Therefore, we can safely make a swap.</p>
<p>The following is the figure showing a batch. Users can click any type of transaction to add it and click <code>Submit</code> all transactions at once. It is important to note that the indexes indicate the order in which the transactions will be executed.</p>
<figure><img src="guides/../assets/image (10).png" alt=""><figcaption></figcaption></figure>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sign-reject-and-resolve-proposals"><a class="header" href="#sign-reject-and-resolve-proposals">Sign, Reject and Resolve Proposals</a></h1>
<p>After proposals have been created, their state will represent it on the proposals page sorting by creating time, as the figure shows. Users can click them to see more details. </p>
<figure><img src="guides/../assets/image (59).png" alt=""><figcaption></figcaption></figure>
<p>We can also interact with the proposals by signing, rejecting, or resolving them based on the conditions of the proposals.</p>
<ul>
<li>Signing proposals means owners give their approvals</li>
<li>Rejecting proposals means owners disagree with the proposals.</li>
<li>Resolving proposals means owners can
<ul>
<li>execute and archive the proposals if acquiring sufficient approvals.</li>
<li>archive the proposals if the proposals exceed their duration</li>
<li>archive the proposals if the proposals are rejected by most of the owners so they can’t pass the threshold to execute.</li>
</ul>
</li>
</ul>
<p>It’s possible to sign (or reject) and resolve at the same time If some conditions are satisfied. After proposals are resolved successfully, they will be archived and presented on the history page. Notice that only the owners of the wallet are permitted to interact with it.</p>
<p>The following is using a 2-of-2 TzSafe wallet as an example.</p>
<h3 id="case-sign-and-resolve-proposal-1"><a class="header" href="#case-sign-and-resolve-proposal-1">Case: Sign and Resolve Proposal 1 <a href="guides/sign-reject-and-resolve-proposals.html#4aa78d07-9469-4fbe-9ad8-ca0556852e43" id="4aa78d07-9469-4fbe-9ad8-ca0556852e43"></a></a></h3>
<p>For the whole new proposal, we shall see two buttons for rejecting and signing as above picture. When clicking either button, we shall see a pop-up window for confirming the action as below figure. Clicking Confirm will process the sign action in this case.</p>
<figure><img src="guides/../assets/image (58).png" alt=""><figcaption></figcaption></figure>
<p>The stats of the proposal will change to <code>Waiting for signers</code>, which means it is pending another owner’s action.</p>
<figure><img src="guides/../assets/image (21).png" alt=""><figcaption></figcaption></figure>
<p>Once the proposal accumulates sufficient approvals, we may see a resolve button there. By clicking it, the window will pop up and ask for confirmation.</p>
<figure><img src="guides/../assets/image (34).png" alt=""><figcaption></figcaption></figure>
<p>We can double-check the proposal and then click <code>Confirm</code>. The proposal should be resolved, executed, and archived on the history page.</p>
<figure><img src="guides/../assets/image (46).png" alt=""><figcaption></figcaption></figure>
<h3 id="case-sign-and-resolve-proposal-2"><a class="header" href="#case-sign-and-resolve-proposal-2">Case: Sign and Resolve Proposal 2 <a href="guides/sign-reject-and-resolve-proposals.html#abeceeda-381c-46e0-980b-eb8a0323a014" id="abeceeda-381c-46e0-980b-eb8a0323a014"></a></a></h3>
<p>The below figure is another example, if looking at the details of proposal 2, another approval is already there. In this case, we can try to sign and resolve the proposal at the same time. First, we click <code>Sign</code>.</p>
<figure><img src="guides/../assets/image (8).png" alt=""><figcaption></figcaption></figure>
<p>We should see the trying to resolve option represented on the popped-up windows. We select “yes” and click <code>Confirm</code> to resolve the proposal.</p>
<figure><img src="guides/../assets/image (28).png" alt=""><figcaption></figcaption></figure>
<h3 id="case-fail-to-resolve-proposal"><a class="header" href="#case-fail-to-resolve-proposal">Case: Fail to Resolve Proposal <a href="guides/sign-reject-and-resolve-proposals.html#544a2e9e-4625-4305-ad56-39bc95ac8f94" id="544a2e9e-4625-4305-ad56-39bc95ac8f94"></a></a></h3>
<p>Sometimes, proposals may be not successfully resolved. For example, the following proposal proposes to transfer an amount that is more than the wallet has. Therefore, if we are trying to resolve the proposal, which can’t be actually resolved, the failed message will be present after clicking <code>Confirm</code>.</p>
<figure><img src="guides/../assets/image (31).png" alt=""><figcaption></figcaption></figure>
<figure><img src="guides/../assets/image (27).png" alt=""><figcaption></figcaption></figure>
<p>The error will show as above. We can see more detail there. In this case, the error results from insufficient balance. Either owner can fund more money into the wallet, or reject the proposal.</p>
<h3 id="case-resolve-expired-proposal"><a class="header" href="#case-resolve-expired-proposal">Case: Resolve Expired Proposal <a href="guides/sign-reject-and-resolve-proposals.html#c19b6f64-f1b9-40e8-aadd-088b9eb8883b" id="c19b6f64-f1b9-40e8-aadd-088b9eb8883b"></a></a></h3>
<p>If none of the owners resolve proposals within the proposal duration, the state of the proposals will become expired. Any owners can click resolved to archive the proposals.</p>
<figure><img src="guides/../assets/image (20).png" alt=""><figcaption></figcaption></figure>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setting"><a class="header" href="#setting">Setting</a></h1>
<p>The settings are divided into two categories.</p>
<h3 id="changes-require-proposing-a-proposal"><a class="header" href="#changes-require-proposing-a-proposal">Changes require proposing a proposal <a href="guides/setting.html#31c1b944-1549-4a9b-a8b7-f2e6c8ce23a8" id="31c1b944-1549-4a9b-a8b7-f2e6c8ce23a8"></a></a></h3>
<p>The change involves contracts, so we will need to create a proposal and go through gathering approvals and rejects process to alter, such as threshold, owners, and proposal duration. The created proposals will present on the proposals page.</p>
<p>We can add owners by clicking <code>Add Owner</code> ; and remove by <code>Remove</code>. When adding new owners, we can also provide aliases. We can also like to modify the <code>Threshold</code> as well as the <code>Proposal duration</code>. Finally, we have the option to delegate our wallet by adding a baker in <code>Delegate wallet</code>.</p>
<p>After we are satisfied with the changes, please double-check all the settings, especially check if we just unexpectedly remove ourselves from owners. Finally, click <code>Save</code> and then all changes will be in the newly created proposal.</p>
<figure><img src="guides/../assets/image (5).png" alt=""><figcaption></figcaption></figure>
<h3 id="change-without-proposal"><a class="header" href="#change-without-proposal">Change Without proposal <a href="guides/setting.html#b0d2a202-5932-43e1-bc96-b6b4e5087028" id="b0d2a202-5932-43e1-bc96-b6b4e5087028"></a></a></h3>
<p>Currently, there is only one change that needs no proposal. That is to remove an imported wallet from the sidebar. The data of the imported wallet is only stored locally. Thus, it’s merely deleting data from our local. The wallet will still remain on-chain.</p>
<p>If we don’t want the wallet present on the sidebar anymore, click the <code>Deleting wallet</code> button in the top right corner of the setting page. After clicking, we will see the button showing deleting. Please wait for a few seconds to fully delete the wallet. If we accidentally delete the wallet, don’t worry. We can import it back by Import wallet.</p>
<figure><img src="guides/../assets/image (47).png" alt=""><figcaption></figcaption></figure>
<div style="break-before: page; page-break-before: always;"></div><h1 id="understand-entrypoint"><a class="header" href="#understand-entrypoint">Understand Entrypoint</a></h1>
<p>TzSafe, a multisig wallet, is created using a smart contract. The TzSafe application, <a href="https://tzsafe.marigold.dev">TzSafe UI</a>, offers a user-friendly interface for interacting with wallets. If users wish to develop their own smart contract to interact with TzSafe, understanding the entrypoints of the wallets is crucial. This section will introduce the entrypoints of TzSafe in different versions. We'll use Better-Call Dev as an example to demonstrate.</p>
<p>To determine the version of TzSafes:</p>
<ul>
<li>Within the TzSafe application, you can find the version information as follows:</li>
</ul>
<p><img src="guides/../assets/image-70.png" alt="" /></p>
<h2 id="version-03x"><a class="header" href="#version-03x">Version ≥0.3.x</a></h2>
<ul>
<li>In version 0.3.3, parameter of entrypoints are self-explanatory, and the proof has been temporarily removed for redesign</li>
<li>Beginning with version 0.3.2, wallets now support two new types of proposals: <code>add_or_update_metadata</code> and <code>remove_metadata</code>. Please note that this support is available only in the contract, not in the TzSafe UI.</li>
<li>Beginning with version 0.3.1, wallets will free up storage space upon the resolution of proposals, leading to savings on storage fees for subsequent proposal creations. Please be aware of security issue: the newly added entrypoint for updating metadata does not check ownership, which means that anyone can modify the wallet's metadata.</li>
<li>Beginning with version 0.3.0, wallets can generate proof.</li>
</ul>
<h3 id="version-033"><a class="header" href="#version-033">Version 0.3.3</a></h3>
<p>Beginning with this version, entrypoint parameters are self-explanatory, enabling users to easily interact wth Better-Call Dev.</p>
<p>Once creating the proposal, users can find the proposal ID in an emitted event with the tag <strong><code>%create_proposal</code></strong>. This ID can be used for signing and resolving the proposal. Upon resolution, the proposal is removed from the contract storage. Users can retrieve the full history from the emitted event with the tag <strong><code>%archive_proposal</code></strong>, and the event's content is in bytes. Here is the type for unpacking it.</p>
<ul>
<li><a href="https://github.com/marigold-dev/tzsafe-ui/blob/v0.42.0-rc.0/types/Proposal0_3_3.ts#L44">here</a> in JSON format.</li>
<li><a href="https://github.com/marigold-dev/tzsafe/blob/0.3.3/src/internal/storage.mligo#L38">here</a> in the camligo.</li>
</ul>
<h3 id="version-032"><a class="header" href="#version-032">Version 0.3.2</a></h3>
<p>To align with TZIP-27, TzSafe team offers several proposed models for integration. For more detailed information, please refer to <a href="https://forum.tezosagora.org/t/tzsafe-and-proof-of-event-with-demos/5672">this link</a>. We have chosen to implement the &quot;PoE as an executed action&quot; model, and we will maintain the usage of the term &quot;actions&quot; as a way to distinguish them from Tezos' standard transactions.</p>
<p>💡 Transactions approved through the owners' consensus are referred to as &quot;actions&quot; to differentiate the term from Tezos' standard transactions.</p>
<p>Regarding the interface adaptation, it may seem complex and daunting for users when dealing with the entrypoints and parameters required for signing and resolving proposals. On the contrary, the process is straightforward. Users do not need to calculate signatures or hash data themselves. From proposal creation to resolution, all that's needed is a blocker explorer to check the results of the operations.</p>
<h3 id="create-a-proposal"><a class="header" href="#create-a-proposal">Create a Proposal</a></h3>
<p>The <strong><code>create_proposal</code></strong> entrypoint is employed to generate proposals, taking a list of proposal contents as its parameter. </p>
<p><img src="guides/../assets/image-71.png" alt="" /></p>
<p>By clicking <code>+ADD</code>, we can select the kind of proposal to create.</p>
<p><img src="guides/../assets/image-72.png" alt="" /></p>
<p>When designing the TzSafe contract, appropriate annotations are assigned to each variable within the parameters. Consequently, when inspecting the TzSafe contract on Better-Call Dev, interaction is straightforward, as each field is largely self-explanatory.</p>
<p><img src="guides/../assets/image-73.png" alt="" /></p>
<p>Upon the successful creation of a proposal by an owner, an event tagged <strong><code>%create_proposal</code></strong> is emitted.</p>
<p><img src="guides/../assets/image-74.png" alt="" /></p>
<p><img src="guides/../assets/image-75.png" alt="" /></p>
<p>This event includes two pieces of information that we'll need them to sign and resolve the proposal:</p>
<ul>
<li><strong><code>challenge_id</code></strong>: This represents a unique ID for each proposal, presented in bytes. With each new proposal, the ID increases by one.</li>
<li><strong><code>payload</code></strong>: This contains the proposal's content but is encoded in Michelson's <strong><code>pack</code></strong>. If we  <strong><code>unpack</code></strong> the payload, it should match the input parameter. However, typically, there's no need to <strong><code>unpack</code></strong>. If the need does arise, we must specify the type, which can be found either:
<ul>
<li><a href="https://github.com/marigold-dev/tzsafe-ui/blob/v0.38.0/types/Proposal0_3_2.ts#L164">here</a> in JSON format.</li>
<li><a href="https://github.com/marigold-dev/tzsafe/blob/0.3.2/src/internal/proposal_content.mligo#L19">here</a> in the camligo. Please note that you need to include this type in the list, as illustrated in the example below.</li>
</ul>
</li>
</ul>
<p>Here's an example of using <strong><code>unpack</code></strong> in the camligo:</p>
<pre><code>&gt;  git clone git@github.com:marigold-dev/tzsafe.git
&gt;  cd tzsafe
&gt;  cat unpack_proposal_contents.mligo

#import &quot;./tzsafe/src/internal/proposal_content.mligo&quot; &quot;Proposal_content&quot;

type proposal_content = Proposal_content.Types.t
type proposal_contents = proposal_content list

&gt; cat unpack_proposal_contents.mligo
let test_unpack_proposal_contents =
  // remember to add prefix &quot;0x&quot; to the bytes receiving from the event with tag `%create_proposal`
  let bytes = 0x0502000000250508050807070a0000001601361c589d324f1575cccb0adcb58664174c74ee7c000080897a in
  // print unpack result
  Test.log (Bytes.unpack bytes : proposal_contents option)

&gt;  ligo run test unpack_proposal_contents.mligo
Some ([Transfer ({amount = 1000000mutez ; target = KT1DWt1ec76EPrvavMS4Rz95hkYGJFLP3iTp})])
Everything at the top-level was executed.
- test_unpack_proposal_content exited with value ().
</code></pre>
<h3 id="sign-a-proposal"><a class="header" href="#sign-a-proposal">Sign a Proposal</a></h3>
<p>The <strong><code>sign_proposal</code></strong> entrypoint is used to sign a proposal. To sign a proposal, it must first be created. Therefore, we can only provide the <strong><code>challenge_id</code></strong> and <strong><code>payload</code></strong> obtained during the proposal creation. If we agree to execute the proposal, the <strong><code>agreement</code></strong> field should be set to <strong><code>true</code></strong> (check the checkbox); otherwise, it should be set to <strong><code>false</code></strong>(uncheck the checkbox).</p>
<p><img src="guides/../assets/image-76.png" alt="" /></p>
<p>TzSafe requires <strong><code>payload</code></strong> to be provided again in <strong><code>sign_proposal</code></strong> to prevent reorgs. By verifying both the <strong><code>challenge_id</code></strong> and <strong><code>payload</code></strong>, TzSafe ensures that we are executing the intended content.</p>
<p>Once the signing is completed, an event is emitted with the tag <strong><code>%sign_proposal</code></strong>. This event is simply for displaying the signing result.</p>
<p><img src="guides/../assets/image-77.png" alt="" /></p>
<h3 id="resolve-a-proposal-and-generate-the-proof"><a class="header" href="#resolve-a-proposal-and-generate-the-proof">Resolve a Proposal and Generate the Proof</a></h3>
<p>The entrypoint for resolving is named <strong><code>challenge_proof_of_event</code></strong> in accordance with TZIP-27. However, it can only be successfully performed when certain conditions are met. Please see <a href="guides/./sign-reject-and-resolve-proposals.html">here</a> for more details.</p>
<p>Similar to signing a proposal, we need to provide the <strong><code>challenge_id</code></strong> and <strong><code>payload</code></strong> obtained during proposal creation to ensure that reorgs have occurred.</p>
<p><img src="guides/../assets/image-78.png" alt="" /></p>
<p>When this entrypoint is successfully executed, two events are emitted:</p>
<ol>
<li>An event with the tag <strong><code>%resolve_proposal</code></strong> shows the simple result of the proposal, including whether it was <code>executed</code>, <code>rejected</code>, or <code>expired</code>. In most cases, this information is sufficient.</li>
<li>The other event, tagged as <strong><code>%proof_of_event</code></strong>, serves as <em>the proof of event</em> for TZIP-27. This proof contains a pair of <strong><code>challenge_id</code></strong> and <strong><code>payload</code></strong>. The payload is encoded in Michelson's <strong><code>pack</code></strong> . If we perform <strong><code>unpack</code></strong>, we can access the details of the proposal, including signers, resolvers, contents, and more. The type for <strong><code>unpack</code></strong> can be found:
<ul>
<li><a href="https://github.com/marigold-dev/tzsafe-ui/blob/v0.38.0/types/Proposal0_3_1.ts#L42">here</a> in JSON format.</li>
<li><a href="https://github.com/marigold-dev/tzsafe/blob/0.3.2/src/internal/storage.mligo#L38">here</a> in the camligo.</li>
</ul>
</li>
</ol>
<p><img src="guides/../assets/image-79.png" alt="" /></p>
<p>Here is an example of using <strong><code>unpack</code></strong> in the camligo:</p>
<pre><code>&gt;  git clone git@github.com:marigold-dev/tzsafe.git
&gt;  cd tzsafe
&gt;  cat unpack_proposal.mligo
#import &quot;./tzsafe/src/internal/storage.mligo&quot; &quot;Storage&quot;

type proposal = Storage.Types.proposal

let test_unpack_proposal =
  // remember to add prefix &quot;0x&quot; to the bytes receiving from the proof
  let bytes = 0x05070705050505030b0707020000001f07040a00000016000101e9a6d43af927384fcd1068ffc12e461e219f20030a070707070a00000016000101e9a6d43af927384fcd1068ffc12e461e219f2000bfe9bbd30c0707050907070a00000016000101e9a6d43af927384fcd1068ffc12e461e219f2000a7edbbd30c02000000230508050807070a000000160142d3fb211660bcec97e8117919c549337a2cb425000001 in

  // print unpack result
  Test.log (Bytes.unpack bytes : proposal option)

&gt;  ligo run test unpack_proposal.mligo
Some ({contents = [Transfer ({amount = 1mutez ; target = KT1Eg8784FTRicrRW9nt13fvRh1hYKWwFF9X})] ; proposer = {actor = tz28VMEvxy1pwb7prrvGwLw4bQf2eCMn6P1c ; timestamp = timestamp(2023-10-24T08:04:15Z)} ; resolver = Some ({actor = tz28VMEvxy1pwb7prrvGwLw4bQf2eCMn6P1c ; timestamp = timestamp(2023-10-24T08:08:07Z)}) ; signatures = [tz28VMEvxy1pwb7prrvGwLw4bQf2eCMn6P1c -&gt; true] ; state = Executed (())})
Everything at the top-level was executed.
- test_unpack exited with value ().

</code></pre>
<p>Both users and DApps can track the new actions of TzSafe without being inconvenienced by internal TzSafe operations by monitoring the events <strong><code>%proof_of_event</code></strong> or <strong><code>%resolve_proposal</code></strong> tags. We can utilize APIs provided by TZKT or Taquito to assist us in this regard. Please note that if the proof is intended for any purpose, it is crucial to verify the proof as the initial step. In the TzSafe design, each operation containing the proposal resolution will also have only one associated proof.</p>
<h3 id="version-031"><a class="header" href="#version-031">Version 0.3.1</a></h3>
<p>Please pay attention to a security concern: the newly introduced entrypoint for updating metadata in the contract storage, following TZIP-16, does not verify ownership, enabling anyone to modify the wallet's metadata. It's important to note that this issue does not affect the other TzSafe functions, nor the TzSafe UI. Individuals concerned about this issue should consider migrating to at least version 0.3.2.</p>
<p>The following are the types needed if one wants to access the details of the bytes produced by the wallet.</p>
<ul>
<li>
<p>the type of proposals:</p>
<ul>
<li>in <a href="https://github.com/marigold-dev/tzsafe-ui/blob/v0.37.0/types/Proposal0_3_1.ts#L164">JSON</a> format.</li>
<li>in the <a href="https://github.com/marigold-dev/tzsafe/blob/0.3.1/src/internal/proposal_content.mligo#L19">camligo</a>. Please note that you need to include this type in the list.</li>
</ul>
</li>
<li>
<p>the type of proof:</p>
<ul>
<li>in <a href="https://github.com/marigold-dev/tzsafe-ui/blob/v0.37.0/types/Proposal0_3_1.ts#L42">JSON</a> format.</li>
<li>in the <a href="https://github.com/marigold-dev/tzsafe/blob/0.3.1/src/internal/storage.mligo#L38">camligo</a>.</li>
</ul>
</li>
</ul>
<h3 id="version-030"><a class="header" href="#version-030">Version 0.3.0</a></h3>
<p>Version 0.3.0 supports generating proof but does not support saving storage fees. This version is exclusively available on the ghostnet.</p>
<h2 id="version--01"><a class="header" href="#version--01">Version ≤ 0.1</a></h2>
<p>In contrast to version ≥ 0.3.1, the entrypoints and their parameters are self-explanatory and presented in readable types, ensuring a user-friendly interaction with them on Better-Call Dev for developing.</p>
<p>Events are still emitted when proposals are created, signed, and resolved. It's important to note that there is no proof emitted to conform to the TZIP-27 standard.</p>
<p>Please note that there is a legacy proposal content, <code>execute</code> of <code>create_proposal</code>, in the contract. The legacy proposal content functions the same as <code>transfer</code>. The <code>execute</code> was designed to be able to customizabled the type when users generate contracts, allowing the wallet to call other specific contracts. In some cases, if the wallet consistently interacts with a specific contract, this can save on storage and gas fees. Now, we are inclined to use <code>execute_lambda</code> to replace <code>execute</code>, so the <code>execute</code> version has been removed in version ≥ 0.3.1.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logging-in-using-tzsafe-app"><a class="header" href="#logging-in-using-tzsafe-app">Logging in Using TzSafe App</a></h1>
<p><img src="guides/../assets/image-80.png" alt="" /></p>
<p>As of now, the configuration for the TzSafe app hasn't been committed to the beacon-sdk repository. For those who want to quickly try interacting with the TzSafe app through a dApp, please follow these steps:</p>
<pre><code class="language-bash">&gt; git clone git@github.com:marigold-dev/beacon-sdk.git
&gt; npm i
&gt; python -m http.server --directory ./examples
</code></pre>
<ol>
<li>Open your browser.</li>
<li>Go to the Example Dapp: http://localhost:8000/dapp.html.</li>
<li>Click on &quot;Request Permission.&quot;</li>
<li>Select &quot;TzSafe&quot; and enjoy!</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="marigold-docs-theme/marigold.js"></script>

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
